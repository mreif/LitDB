<p id="notice"><%= notice %></p>

<% if @author.image.url.include? "/images/small/missing.png"%>
	<%= image_tag @author.image.url(:small) %>
<% end %>

<table border="1" class="rahmen">
	<tr class="rahmen">
		<td class="rahmen"><b>Name:</b> </td>
		<td class="rahmen"><%= @author.title + " " + @author.first_name + " " + @author.last_name %></td>
	</tr>
	<tr class="rahmen">
		<td class="rahmen"><b>Email:<b/></td>
		<td class="rahmen"><%= mail_to @author.email, nil, :replace_at => "(at)", :encode => "hex" %></td>
	</tr>
	<tr>
		<td class="rahmen"><b>Office:<b/></td>
		<td class="rahmen"><%= @author.office %></td>
	</tr>
	<tr class="rahmen">
		<td class="rahmen"><b>Address:<b/></td>
		<td class="rahmen">
			<%= @author.street %><br />
  			<%= @author.zip_code + " " +  @author.city %>
		</td>
	</tr>
	<tr class="rahmen">
		<td class="rahmen"><b>Phones:<b/></td>
		<td class="rahmen"><%= @author.phone %></td>
	</tr>
	<tr class="rahmen">
		<td class="rahmen"><b>Website:<b/></td>
		<td class="rahmen"><%= link_to( @author.url, @author.url ) %></td>
	</tr>
	<tr class="rahmen">
		<td class="rahmen"><b>Curriculum Vitae:<b/></td>
		<td class="rahmen"><%= @author.cv %></td>
	</tr>
</table>

<br />

<%= link_to 'Edit', edit_author_path(@author) %> |
<%= link_to 'Back', :back %>

<% publications = @author.publications.sort { |a, b| b.year <=> a.year || b.created_at <=> a.created_at } %>
<div class="newslisting">
<% if !publications.empty? %>
<h3 class="news"> Authors Publications </h3>
<% end %>

<% num = 1 %>
<% publications.each do |publication| %>
			<% fauthors_search = getFormatedAuthors(publication.authors.order('authorships.pos ASC')) %>
		<% fauthors = "" %>
			<% authors = publication.authors.order('authorships.pos ASC') %>
			<% authors.each_with_index do |author, i| %>
				<% link_text = author.first_name[0] + ". " + author.last_name %>
				<% link = link_to link_text, author_path(author) %>
				<% fauthors << link %>
				<% fauthors << ((i < authors.length - 1)? ", " : "") %>
			<% end %>
		
		<% if num % 2 == 1 %>
			<div id="<%= publication.title.downcase.gsub(" ", "-") + "-" + fauthors_search.downcase.gsub(" ", "-") %>" class="publication odd">
		<% else %>
			<div id="<%= publication.title.downcase.gsub(" ", "-") + "-" + fauthors_search.downcase.gsub(" ", "-") %>" class="publication even">
		<% end %>
				<span class="paper_author"> <%= num.to_s + ". " %>  <%= simple_format_span fauthors %> </span><br />
				<span class="paper_title"> 
					<%= publication.title %>
				</span>
				<% if publication.upload_file_name != nil %> 
					<%= button_to "PDF",  publication.upload.url(:original, false), :method => :get, class: "glyphicon glyphicon-save" %>
				<% end %>
				<%= button_to "BibTex", publication_bibtex_path(publication), :method => :get,  :remote => 'true', class: "glyphicon glyphicon-book", :style => "display:inline !important;" %>
				<br />
				<span class="paper_bib"> <%= simple_format_span getInformationRow(publication) %> </span>
				<% if user_signed_in? %>
					<table>
					 <td white-space="nowrap"> <%= button_to "Edit", edit_publication_path(publication), :method => :get %> </td>
					 <td white-space="nowrap"><%= button_to "Delete", publication_path(publication), :confirm => 'Are you sure you want to delete this publication?', :method => :delete %> </td>
					</table>		
				<% end %>
			</div>
			<div>
				<div id="bibtex_<%= publication.id.to_s %>"></div>
			</div>			
<% num += 1 %>
<% end %>
</p>
</div>